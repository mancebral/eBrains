<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>eBrains Live</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<style>
/* ----------------- Body ----------------- */
body {
  background: linear-gradient(to bottom, #FF7E5F, #FD3A69, #FFA17F);
  margin: 0;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  color: white;
  text-align: center;
  padding: 10px;
  transition: background 0.25s ease;
}

/* ----------------- Titles ----------------- */
h1 {
  margin-top: 10px;
  font-size: 2.2rem;
}

h3 {
  font-weight: 300;
  font-size: 1.4rem;
  letter-spacing: 0.5px;
  margin-bottom: 10px;
  display: inline-flex;
  align-items: center;
}

/* ----------------- Sliders ----------------- */
.slider-block {
  margin-top: 20px;
}

.slider {
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.slider-label-emoji {
  font-size: 1.4rem;
}

/* ----------------- Input range ----------------- */
input[type=range] {
  -webkit-appearance: none;
  width: 100%;
  height: 6px;
  background: rgba(255,255,255,0.6);
  border-radius: 3px;
  margin: 0 6px;
}

input[type=range]::-webkit-slider-thumb {
  -webkit-appearance: none;
  height: 24px;
  width: 24px;
  border-radius: 50%;
  background: white;
  cursor: pointer;
  margin-top: -9px;
}

input[type=range]::-moz-range-thumb {
  height: 24px;
  width: 24px;
  border-radius: 50%;
  background: white;
  cursor: pointer;
}

/* ----------------- Send Button ----------------- */
#sendButton {
  margin-top: 35px;
  font-size: 1.4rem;
  padding: 16px 30px;
  background: rgba(255,255,255,0.2);
  border: 2px solid white;
  border-radius: 8px;
  color: white;
  cursor: pointer;
  transition: transform 0.2s ease, background 0.2s ease;
}
#sendButton:hover {
  background: rgba(255,255,255,0.3);
  transform: scale(1.04);
}
#sendButton:active {
  transform: scale(0.96);
}

/* ----------------- SENT message ----------------- */
#sentMessage {
  font-size: 1.3rem;
  margin-top: 12px;
  opacity: 0;
  transition: opacity 0.6s ease;
  font-weight: bold;
}

/* ----------------- Tooltip ----------------- */
.info-icon {
  display: inline-flex;
  justify-content: center;
  align-items: center;
  width: 22px;
  height: 22px;
  border: 1px solid rgba(255,255,255,0.7);
  border-radius: 50%;
  color: white;
  font-size: 12px;
  cursor: pointer;
  margin-left: 6px;
  opacity: 0.9;
  background-color: rgba(100, 160, 255, 0.25);
}

.info-icon:hover {
  opacity: 1;
}

.tooltip {
  position: absolute;
  background: rgba(0,0,0,0.7);
  padding: 8px 12px;
  border-radius: 8px;
  font-size: 0.85rem;
  max-width: 200px;
  line-height: 1.3;
  backdrop-filter: blur(5px);
  color: white;
  z-index: 99;
  display: none;
}

/* ----------------- Footer logo ----------------- */
footer img {
  width: 300px;
  opacity: 0.9;
  margin-bottom: 10px;
}

@media(max-width: 500px) {
  footer img {
    width: 85%;
  }
}
</style>
</head>

<body>
<h1>How does music make you feel?</h1>
<p>Share your <b>emotional state</b> as many times as you like during the performance. Your emotions will affect the visualisations in real time.</p>

<!-- VALENCE -->
<div class="slider-block">
  <h3>Valence
    <span class="info-icon" 
          onmouseover="showInfo('info-valence')" 
          onmouseout="hideInfo('info-valence')"
          ontouchstart="showInfo('info-valence')" 
          ontouchend="hideInfo('info-valence')">
      i
    </span>
  </h3>
  <div class="slider">
    <span class="slider-label-emoji">üòû</span>
    <input type="range" id="valence" min="0" max="1" step="0.01" value="0.5">
    <span class="slider-label-emoji">ü§©</span>
  </div>
  <div id="info-valence" class="tooltip">
    Your emotion: from negative to positive (from üòû to ü§©)
  </div>
</div>

<!-- AROUSAL -->
<div class="slider-block">
  <h3>Arousal
    <span class="info-icon" 
          onmouseover="showInfo('info-arousal')" 
          onmouseout="hideInfo('info-arousal')"
          ontouchstart="showInfo('info-arousal')" 
          ontouchend="hideInfo('info-arousal')">
      i
    </span>
  </h3>
  <div class="slider">
    <span class="slider-label-emoji">üò¥</span>
    <input type="range" id="arousal" min="0" max="1" step="0.01" value="0.5">
    <span class="slider-label-emoji">‚ö°</span>
  </div>
  <div id="info-arousal" class="tooltip">
    Your energy: from calm to activated (from üò¥ to ‚ö°)
  </div>
</div>

<!-- DOMINANCE -->
<div class="slider-block">
  <h3>Dominance
    <span class="info-icon" 
          onmouseover="showInfo('info-dominance')" 
          onmouseout="hideInfo('info-dominance')"
          ontouchstart="showInfo('info-dominance')" 
          ontouchend="hideInfo('info-dominance')">
      i
    </span>
  </h3>
  <div class="slider">
    <span class="slider-label-emoji">üòü</span>
    <input type="range" id="dominance" min="0" max="1" step="0.01" value="0.5">
    <span class="slider-label-emoji">üòé</span>
  </div>
  <div id="info-dominance" class="tooltip">
    Your sense of control: from insecure to secure (from üòü to üòé)
  </div>
</div>

<!-- SEND -->
<button id="sendButton">Share in real-time!</button>
<div id="sentMessage">‚úîÔ∏è SENT!</div>

<footer>
  <p>This app is part of the experience <b>Your Brain on Beethoven</b> which takes place in <b>EBRAINS Summit 2025</b></p>
  <img src="https://github.com/mancebral/eBrains/blob/main/accelnet.png?raw=true" alt="eBrains Logo">
</footer>

<!-- ----------------- Firebase ----------------- -->
<script src="https://www.gstatic.com/firebasejs/9.6.8/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.8/firebase-database-compat.js"></script>

<script>
/* ============ FIREBASE CONFIG ============ */
const firebaseConfig = {
  apiKey: "AIzaSyDGKV8B58p6C5jdGHzGzFlC_C2JUhOTbvk",
  authDomain: "ebrains-performance.firebaseapp.com",
  databaseURL: "https://ebrains-performance-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "ebrains-performance",
  storageBucket: "ebrains-performance.appspot.com",
  appId: "1:266141418381:web:d84028ce93d7a90705f3c4"
};

const app = firebase.initializeApp(firebaseConfig);
const db = firebase.database();

/* ---------- Unique User ID ---------- */
let userId = localStorage.getItem("ebrains_user");
if(!userId){
  userId = "user_" + Math.random().toString(36).substring(2,8);
  localStorage.setItem("ebrains_user", userId);
}

/* ---------- Tooltip JS ---------- */
function showInfo(id) {
  document.getElementById(id).style.display = 'block';
}
function hideInfo(id) {
  document.getElementById(id).style.display = 'none';
}

/* ============ üé® Dynamic background ============ */
const v = document.getElementById("valence");
const a = document.getElementById("arousal");
const d = document.getElementById("dominance");

// <-- new
[v,a,d].forEach(slider=>{
  slider.addEventListener("input", updateBackground);
});

function updateBackground(){
  const val = parseFloat(v.value);
  const aro = parseFloat(a.value);
  const dom = parseFloat(d.value);

  // Map sliders to HSL values
  const hue = val * 360;
  const sat = aro * 60 + 40;
  const lig = 30 + dom * 40;

  document.body.style.background =
    `linear-gradient(to bottom,
      hsl(${hue},${sat}%,${lig}%),
      hsl(${hue+30},${sat}%,${lig-10}%)
    )`;
}

/* ---------- Send Data ---------- */
document.getElementById("sendButton").addEventListener("click", () => {
  const valence = parseFloat(v.value);
  const arousal = parseFloat(a.value);
  const dominance = parseFloat(d.value);

  db.ref("live/" + userId).set({
    valence: valence,
    arousal: arousal,
    dominance: dominance,
    ts: Date.now()
  }).then(() => {
    const msg = document.getElementById("sentMessage");
    msg.style.opacity = 1;
    setTimeout(() => msg.style.opacity = 0, 1800);

    if(navigator.vibrate){
      navigator.vibrate(150);
    }
  });
});
</script>

</body>
</html>




